webpackJsonp([13],{"/85O":function(e,t,a){var i=a("Rw8J");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("29c3cc29",i,!0,{})},Rw8J:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"\n.demo-table-expand[data-v-ba3f8870] {\n  font-size: 0;\n}\n.demo-table-expand label[data-v-ba3f8870] {\n  width: 90px;\n  color: #99a9bf;\n}\n.demo-table-expand .el-form-item[data-v-ba3f8870] {\n  margin-right: 0;\n  margin-bottom: 0;\n  width: 50%;\n}\n\n",""])},bXLi:function(e,t,a){"use strict";function i(e){a("/85O")}Object.defineProperty(t,"__esModule",{value:!0});var l=a("mvHQ"),o=a.n(l),n=a("yt7g"),r=a("S49b"),s={data:function(){return{users:[],total:0,page:1,listLoading:!1,dialogvipDataVisible:!1,vipDataForm:{id:"",discount:"",unit_memberday:"",week_memberday:[],month_memberday:[]},week_memberdayOptions:[{value:"2",label:"周一"},{value:"3",label:"周二"},{value:"4",label:"周三"},{value:"5",label:"周四"},{value:"6",label:"周五"},{value:"7",label:"周六"},{value:"1",label:"周日"}],month_memberdayOptions:[{value:"1",label:"一号"},{value:"2",label:"二号"},{value:"3",label:"三号"},{value:"4",label:"四号"},{value:"5",label:"五号"},{value:"6",label:"六号"},{value:"7",label:"七号"},{value:"8",label:"八号"},{value:"9",label:"九号"},{value:"10",label:"十号"},{value:"11",label:"十一号"},{value:"12",label:"十二号"},{value:"13",label:"十三号"},{value:"14",label:"十四号"},{value:"15",label:"十五号"},{value:"16",label:"十六号"},{value:"17",label:"十七号"},{value:"18",label:"十八号"},{value:"19",label:"十九号"},{value:"20",label:"二十号"},{value:"21",label:"二十一号"},{value:"22",label:"二十二号"},{value:"23",label:"二十三号"},{value:"24",label:"二十四号"},{value:"25",label:"二十五号"},{value:"26",label:"二十六号"},{value:"27",label:"二十七号"},{value:"28",label:"二十八号"},{value:"29",label:"二十九号"},{value:"30",label:"三十号"}],vipDataFormRules:{discount:[{required:!0,validator:function(e,t,a){return t?/^[1-9](\.\d+)?$/.test(t)?void a():a(new Error("请输入正确的折扣率")):a(new Error("请输入折扣率"))},trigger:"blur"}]},optionsCode:[],levelOptions:[],codeFormVisible:!1,editFormVipCode:!1,codeLoading:!1,codeMode:!1,codeFormRules:{},loading:!1,codeForm:{wxcard_id:"",store:"",level:""},editVipCode:{vipCode:""}}},methods:{clickCode:function(){window.location.href=this.editVipCode.vipCode},codeSubmit:function(){this.codeLoading=!0;var e={cardid:this.codeForm.wxcard_id,storeId:this.codeForm.store,level:this.codeForm.level};this.codeLoading=!1,this.editVipCode.vipCode=r._7+"?sid="+e.storeId+"&level="+e.level,this.codeMode=!0},clickStore:function(){var e=this;Object(r._48)().then(function(t){var a=(t.status,t.data);e.optionsCode=a.storeList})},remoteStore:function(e){var t=this;""!==e?(this.loading=!0,setTimeout(function(){t.loading=!1,Object(r._48)({sname:e}).then(function(e){var a=(e.status,e.data);t.optionsCode=a.storeList})},200)):this.options=[]},closeDialog:function(){this.codeMode=!1,this.codeForm.store="",this.codeForm.level=""},deliveryCode:function(e,t){var a=this;this.codeFormVisible=!0,this.codeForm.wxcard_id=t.wxcard_id,Object(r._22)().then(function(e){200===e.status&&(a.levelOptions=e.data.levelList)})},vipDataClick:function(e,t){var a=this;this.dialogvipDataVisible=!0,this.vipDataForm.id=t.id,Object(r._24)({id:String(t.id)}).then(function(e){var t=e.status,i=e.message;if(200==t){var l=String(e.data.discount);a.vipDataForm.discount=a.vipDataForm.discount="undefined"==l?"":l,a.vipDataForm.unit_memberday="DAY_OF_WEEK"==e.data.unit?a.vipDataForm.unit_memberday="2":"DAY_OF_MONTH"==e.data.unit?a.vipDataForm.unit_memberday="1":a.vipDataForm.unit_memberday="2","2"==a.vipDataForm.unit_memberday?a.vipDataForm.week_memberday=e.data.dayList:a.vipDataForm.month_memberday=e.data.dayList}else a.$message({message:i,type:"warning"})})},submitvipData:function(){var e=this,t="";t="2"==this.vipDataForm.unit_memberday?this.vipDataForm.week_memberday:this.vipDataForm.month_memberday;var a={id:String(this.vipDataForm.id),unit:this.vipDataForm.unit_memberday,dayList:t,discount:this.vipDataForm.discount};a.unit=2==this.vipDataForm.unit_memberday?a.unit="DAY_OF_WEEK":a.unit="DAY_OF_MONTH",Object(r.c)(a).then(function(t){var a=t.status,i=t.message;200==a?(e.$message({message:i,type:"success"}),e.dialogvipDataVisible=!1,e.getUsers()):e.$message({message:i,type:"warning"})})},modifyClick:function(e,t){var a=t.id;sessionStorage.setItem("id",o()(a)),this.$router.push({path:"/index3/tab1-modify"})},rechargeClick:function(e,t){var a=t.wxcard_id;sessionStorage.setItem("wxcard_id",o()(a)),this.$router.push({path:"/index3/tab11"})},stockClick:function(e,t){var a=this;if(console.log(t.addQuantity),/^\+?[1-9][0-9]*$/.test(t.addQuantity)){var i={id:String(t.id),addQuantity:t.addQuantity};Object(r._6)(i).then(function(e){var t=e.status,i=e.message;200==t?(a.$message({message:i,type:"success"}),window.location.reload()):a.$message({message:i,type:"warning"})})}else this.$message.error("请输入正确库存数量")},date_info:function(e,t){return"DATE_TYPE_PERMANENT"==e.date_info?"永久有效":e.date_info=n.f.format(new Date(e.begin_time))+"至"+n.f.format(new Date(e.end_time))},status:function(e,t){return 2==e.status?"上传成功":1==e.status?"未上传":3==e.status?"上传失败":"未知"},handleCurrentChange:function(e){this.page=e,this.getList()},getUsers:function(){this.page=1,this.getList()},getList:function(){var e=this;this.listLoading=!0;var t={pagNum:this.page};Object(r._23)(t).then(function(t){e.total=t.data.total,e.users=t.data.memCardList,e.listLoading=!1})},handleAdd:function(){this.$router.push("/index3/tab1s")},uploadWinxin:function(e,t){var a=this,i={id:t.id};Object(r._78)(i).then(function(e){var t=e.status,i=e.message;200==t?(a.$notify({title:"成功",message:i,type:"success"}),a.getUsers()):a.$notify.error({title:"错误",message:i})})}},mounted:function(){this.getUsers()}},d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-row",[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",size:"medium",round:""},on:{click:e.handleAdd}},[e._v("新增会员卡")])],1),e._v(" "),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",size:"medium",round:""},on:{click:e.getUsers}},[e._v("查询")])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}]},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"id",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"会员卡名称","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wxcard_id",label:"会员卡ID","min-width":"280"}}),e._v(" "),a("el-table-column",{attrs:{prop:"date_info",label:"会员卡有效期",formatter:e.date_info,"min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",formatter:e.status}}),e._v(" "),a("el-table-column",{attrs:{label:"剩余库存","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{staticStyle:{width:"80px","text-align":"center"},attrs:{type:"gray"}},[e._v(e._s(t.row.quantity))]),e._v(" "),a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini",maxlength:6},model:{value:t.row.addQuantity,callback:function(a){e.$set(t.row,"addQuantity",a)},expression:"scope.row.addQuantity"}}),e._v(" "),a("el-button",{attrs:{plain:"",type:"success",size:"mini"},on:{click:function(a){e.stockClick(t.$index,t.row)}}},[e._v("增加")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{trigger:"click"}},[a("el-button",{attrs:{size:"mini",type:"warning"}},[e._v("\n                更多菜单\n                "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){e.vipDataClick(t.$index,t.row)}}},[e._v("会员日")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){e.modifyClick(t.$index,t.row)}}},[e._v("修改")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){e.rechargeClick(t.$index,t.row)}}},[e._v("充值设置")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){e.deliveryCode(t.$index,t.row)}}},[e._v("投放二维码")]),e._v(" "),2!=t.row.status?a("el-dropdown-item",{nativeOn:{click:function(a){e.uploadWinxin(t.$index,t.row)}}},[e._v("上传微信")]):a("el-dropdown-item",{attrs:{disabled:!0}},[e._v("已上传")])],1)],1)]}}])})],1)],1),e._v(" "),a("el-row",[a("el-pagination",{staticStyle:{"text-align":"center",background:"#fff",padding:"15px"},attrs:{layout:"prev, pager, next","current-page":e.page,"page-size":20,total:e.total,background:""},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"投放设置",visible:e.codeFormVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.codeFormVisible=t},close:e.closeDialog}},[a("el-form",{ref:"codeForm",attrs:{model:e.codeForm,"label-width":"80px",rules:e.codeFormRules}},[a("el-form-item",{attrs:{label:"选择门店",prop:"store"}},[a("el-select",{attrs:{placeholder:"请选择门店名称",multiple:!1,filterable:"",remote:"",clearable:"","remote-method":e.remoteStore,loading:e.loading},on:{"visible-change":e.clickStore},model:{value:e.codeForm.store,callback:function(t){e.$set(e.codeForm,"store",t)},expression:"codeForm.store"}},e._l(e.optionsCode,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"选择等级",prop:"parag"}},[a("el-select",{attrs:{placeholder:"请选择等级",clearable:""},model:{value:e.codeForm.level,callback:function(t){e.$set(e.codeForm,"level",t)},expression:"codeForm.level"}},e._l(e.levelOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.level_name,value:e.level}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.codeLoading},nativeOn:{click:function(t){return e.codeSubmit(t)}}},[e._v("生成二维码")])],1)],1),e._v(" "),e.codeMode?a("el-form",{ref:"editVipCode",staticStyle:{width:"auto"},attrs:{model:e.editVipCode,"label-width":""}},[a("el-form-item",{staticStyle:{"text-align":"center","margin-bottom":"0"}},[a("img",{attrs:{src:e.editVipCode.vipCode,alt:"二维码",width:"260px"}})]),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-bottom":"0"}},[a("el-button",{attrs:{type:"success"},on:{click:e.clickCode}},[e._v("点击下载")])],1)],1):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:"绑定会员",visible:e.dialogvipDataVisible,width:"600px"},on:{"update:visible":function(t){e.dialogvipDataVisible=t}}},[a("el-form",{ref:"vipDataForm",attrs:{model:e.vipDataForm,rules:e.vipDataFormRules}},[a("el-form-item",{attrs:{label:"折扣率（“1”到“10”）",prop:"discount"}},[a("el-input",{model:{value:e.vipDataForm.discount,callback:function(t){e.$set(e.vipDataForm,"discount",t)},expression:"vipDataForm.discount"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"设置会员日"}},[[a("el-radio",{staticClass:"radio",attrs:{label:"1"},model:{value:e.vipDataForm.unit_memberday,callback:function(t){e.$set(e.vipDataForm,"unit_memberday",t)},expression:"vipDataForm.unit_memberday"}},[e._v("月单位")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"2"},model:{value:e.vipDataForm.unit_memberday,callback:function(t){e.$set(e.vipDataForm,"unit_memberday",t)},expression:"vipDataForm.unit_memberday"}},[e._v("周单位")])],e._v(" "),2==this.vipDataForm.unit_memberday?[a("el-select",{attrs:{multiple:"",placeholder:"请选择周会员日"},model:{value:e.vipDataForm.week_memberday,callback:function(t){e.$set(e.vipDataForm,"week_memberday",t)},expression:"vipDataForm.week_memberday"}},e._l(e.week_memberdayOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]:e._e(),e._v(" "),1==this.vipDataForm.unit_memberday?[a("el-select",{attrs:{multiple:"",placeholder:"请选择月会员日"},model:{value:e.vipDataForm.month_memberday,callback:function(t){e.$set(e.vipDataForm,"month_memberday",t)},expression:"vipDataForm.month_memberday"}},e._l(e.month_memberdayOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]:e._e()],2)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogvipDataVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitvipData("vipDataForm")}}},[e._v("确 定")])],1)],1)],1)},m=[],c={render:d,staticRenderFns:m},u=c,v=a("VU/8"),p=i,b=v(s,u,!1,p,"data-v-ba3f8870",null);t.default=b.exports}});